{% extends 'main.html' %}
{% load static %}
{% block content %}
<div class="row">
     <div class="col-lg-12">
          <div class="box-element">

               <a  class="btn btn-outline-dark" href="{% url 'store' %}">&#x2190; Continue Shopping</a>

               <br>
               <br>
               <table class="table">
                    <tr>
                         {% if order is not None %}
                         <th><h5>Items: <strong>{{order.get_cart_items}}</strong></h5></th>
                         <th><h5>Total:<strong> Ksh{{order.get_cart_total|floatformat:2}}</strong></h5></th>
                         <th>
                              <a  style="float:right; margin:5px;" class="btn btn-success" href="{% url 'checkout' %}">Checkout</a>
                         </th>
                         {% else %}
                         <th>None</th>
                         {% endif %}
                    </tr>
               </table>

          </div>

          <br>
          <div class="box-element">
               <div class="cart-row">
                    <div style="flex:2"></div>
                    <div style="flex:2"><strong>Item</strong></div>
                    <div style="flex:1"><strong>Price</strong></div>
                    <div style="flex:1"><strong>Quantity</strong></div>
                    <div style="flex:1"><strong>Total</strong></div>
               </div>
               {% for item in items %}
               <div class="cart-row">
                    {{item.id}}
                    <div style="flex:2"><img class="row-image" src="{{item.product.imageURL}}"></div>
                    <div style="flex:2"><p>{{item.product.name}}</p></div>
                    <div style="flex:1"><p>Ksh{{item.product.price|floatformat:2}}</p></div>
                    <div style="flex:1">
                         <p class="quantity">{{item.quantity}}</p>
                         <div class="quantity">
                             <a href="{% url 'update_add_item' item.product.id %}"> <img data-product="{{item.product.id}}" data-action="add" class="chg-quantity update-cart" src="{% static  'images/arrow-up.png' %}"></a>

					
						<a href="{% url 'update_remove_item' item.product.id %}"><img data-product="{{item.product.id}}" data-action="remove" class="chg-quantity update-cart" src="{% static  'images/arrow-down.png' %}"></a>
                         </div>
                    </div>
                    <div style="flex:1"><p>Ksh{{item.get_total}}</p></div>
                    <a href="{% url 'delete_item' item.id %}"><button class="btn btn-danger">Delete</button></a>
               </div>
               {% endfor %}
               
                
          </div>
     </div>
</div>

<script type="text/javascript">
     // get cart count from cookie
     var cart_count = JSON.parse(getCookie('cart')).length;
     
     // update cart icon number
     document.querySelector('.cart-count').textContent = cart_count;
     
     // function to get cookie
     function getCookie(name) {
         var cookieArr = document.cookie.split(";");
 
         for(var i = 0; i < cookieArr.length; i++) {
             var cookiePair = cookieArr[i].split("=");
 
             if(name == cookiePair[0].trim()) {
                 return decodeURIComponent(cookiePair[1]);
             }
         }
 
         return null;
     }
 </script>
{% endblock content %}